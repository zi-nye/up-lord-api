<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="uplord.uplordapi.domain.attendance.dao.AttendanceDao">
    <update id="updateAttendanceToYN" parameterType="AttendanceRequestDto">
        UPDATE ATTENDANCE
        SET ATTENDANCE_YN = #{attendanceYn}
        WHERE ATTENDANCE_ID = #{attendanceId}
    </update>

    <select id="findAttendanceByRequestDto" parameterType="AttendanceRequestDto" resultType="Attendance">
        SELECT
            M.MEMBER_IDX
             , M.MEMBER_NAME
             , M.NTH_YEAR
             , M.CELL_NAME
             , M.GENDER
             , A.ATTENDANCE_YN
             , A.MEMO
        FROM MEMBER M
        JOIN ATTENDANCE A on M.MEMBER_IDX = A.MEMBER_IDX
        WHERE USE_YN = 'Y'
    </select>

    <insert id="createAttendance" parameterType="RegisterAttendanceCommand">
        INSERT INTO ATTENDANCE (
            MEMBER_IDX
            , WRITE_DATE
            , MEMO
            , ATTENDANCE_YN
            , CREATED_UID
            , CREATED_AT
            , CREATED_IP
            , UPDATED_UID
            , UPDATED_AT
            , UPDATED_IP
        )
        VALUES (
              #{memberIdx}
            , #{writeDate}
            , #{memo}
            , #{attendanceYn}
            , #{createdUid}
            , #{createdAt}
            , #{createdIp}
            , #{updatedUid}
            , #{updatedAt}
            , #{updatedIp}
        )
    </insert>

</mapper>